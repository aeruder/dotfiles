#!/bin/bash

# Failed commands aborts script
set -e
# Uninitialized expansion aborts script
set -u
# Any command in a pipe failing aborts script
set -o pipefail

commonargs=(--env=DEV_NO_SIMDB --env=DBIC_TRACE --env=SCREEN_LOG_LEVEL --host=sandbox)
gitroot="`git root 2>/dev/null || true`"
if [ -n "$gitroot" ] && [ -f "$gitroot"/.zr-installation-root ]; then
  curdir="`pwd`"
  curreldir="${curdir#$gitroot}"
  if [ "$curreldir" != "$curdir" ]; then
    exec run-remote "${commonargs[@]}" \
         --dir='ziprecruiter'"$curreldir" "$@"
  fi
fi

exec run-remote "${commonargs[@]}" \
      --dir='ziprecruiter' "$@"
